<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SPARK - MYPAGE</title>
  <link rel="stylesheet" href="/stylesheets/myapage.css">
  <link rel="icon" href="/favicon.png" type="image/png">
</head>
<body>
  <header class="header">
    <div class="logo">
      <img src="/favicon.png" alt="로고" class="favicon">
      <h1>MYPAGE</h1>
    </div>
    <nav class="nav">
      <a href="/main">MAIN</a>
      <a href="/login">LOGOUT</a>
    </nav>
  </header>
  <main class="mypage-container">
    <section class="profile-box">
      <p class="profile-label">profile</p>
      <div class="profile-content">
        <div class="profile-img" id="profile-img"></div>
        <div class="profile-text">
          <p id="username">이름</p>
          <p id="email">@seoultech.ac.kr</p>
        </div>
      </div>
    </section>

    <section class="study-box">
      <p class="study-label">MY STUDY</p>
      <ul class="study-list">
        <% studies.forEach(study=> { %>
          <li class="study-item">
            <strong>
              <%= study.title %>
            </strong><br>
            <div class="button-group">
              <form action="/studyR/studies/delete/<%= study.id %>" method="POST" style="display:inline;">
                <button type="submit" class="study-button delete-button">삭제</button>
              </form>
              <form action="/studyR/studies/edit/<%= study.id %>" method="GET" style="display:inline;">
                <button type="submit" class="study-button edit-button">수정</button>
              </form>

              <form action="/studyR/studies/applicants/<%= study.id %>" method="GET" style="display:inline;">
                <button type="submit" class="study-button">지원자 보기</button>
              </form>
            </div>
          </li>
          <% }) %>        
      </ul>

      <!-- 스터디 등록 -->
      <a class="new-study-btn" id="toStudyWrite">새로운 스터디 만들기</a>
    </section>
    <!-- 🙋 내가 지원한 스터디 목록 -->
     <section class="applied-box">
      <p class="study-label">지원한 스터디 결과</p>
      <% if (myApplications.length === 0) { %>
        <p>아직 지원한 스터디가 없습니다.</p>
        <% } else { %>
          <ul class="applied-list">
            <% myApplications.forEach(app => { %>
              <li>
                <strong><%= app.title %></strong>
                (마감일: <%= app.deadline %>) -
                결과: <%= app.status %>
              </li>
              <% }) %>
            </ul>
            <% } %>
          </section>
  </main>

  <script>
    document.getElementById('toStudyWrite').addEventListener('click', () => {
      window.location.href = '/studyR/studies/new';  // 스터디 등록 페이지 라우트 URL
    });
  </script>
</body>
</html>