<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title><%= study.title %> | 스터디 상세보기</title>
</head>
<body>

  <h1><%= study.title %></h1>

  <p><strong>설명:</strong> <%= study.description || '내용 없음' %></p>

  <% let techList = []; try { techList = JSON.parse(study.techstack); } catch(e) {} %>
  <p><strong>기술 스택:</strong>
    <% if (techList.length > 0) { %>
      <% techList.forEach(t => { %>
        <span><%= t.value %></span>
      <% }) %>
    <% } else { %>
      없음
    <% } %>
  </p>

  <p><strong>모집 인원:</strong> <%= study.team_size || '미정' %>명</p>
  <p><strong>진행 방식:</strong> <%= study.progress_method || '미정' %></p>
  <p><strong>마감일:</strong> <%= study.deadline || '없음' %></p>
  <p><strong>모집 조건:</strong> <%= study.requirements || '없음' %></p>

  <% if (study.thumbnail) { %>
    <img src="/uploads/<%= study.thumbnail %>" alt="스터디 이미지" width="300">
  <% } %>

  <% if (study.location_lat && study.location_lng) { %>
    <div id="map" style="width:100%;height:300px;margin-top:1rem;"></div>
    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=<%= process.env.KAKAO_JAVASCRIPT_KEY %>"></script>
    <script>
      const lat = parseFloat('<%= study.location_lat %>');
      const lng = parseFloat('<%= study.location_lng %>');
      if (!isNaN(lat) && !isNaN(lng)) {
        const map = new kakao.maps.Map(document.getElementById('map'), {
          center: new kakao.maps.LatLng(lat, lng),
          level: 3
        });
        new kakao.maps.Marker({
          position: new kakao.maps.LatLng(lat, lng),
          map
        });
      }
    </script>
  <% } else { %>
    <p>위치 정보 없음</p>
  <% } %>

  <!--  지원하기 버튼 -->
  <form action="/apply/<%= study.id %>" method="get">
    <button type="submit">이 스터디에 지원하기</button>
  </form>

  <p><a href="/">← 메인으로 돌아가기</a></p>

</body>
</html>



